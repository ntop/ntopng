{
   "swagger":"2.0",
   "info":{
      "version":"3.9",
      "title":"ntopng",
      "description":"ntopng RESTful API documentation"
   },
   "tags":[
      {
         "name":"Interfaces",
         "description":"Everything about interfaces"
      },
      {
         "name":"Hosts",
         "description":"Everything about hosts"
      },
	  {
	     "name":"Alerts",
	     "description":"Everything about alerts"
	  },
	  {
	     "name":"Flows",
	     "description":"Everything about flows"
	  },
	  {
	     "name":"PCAP",
	     "description":"Raw PCAP traffic"
	  }
   ],
   "schemes":[
      "https",
      "http"
   ],
   "paths":{
      "/lua/rest/get/interface/data.lua":{
         "get":{
            "tags":[
               "Interfaces"
            ],
            "summary":"Get interface data",
            "description":"Interface data is returned",
            "operationId":"get_interface_data",
            "produces":[
               "application/json"
            ],
            "parameters":[
               {
                  "name":"ifid",
                  "in":"query",
                  "description":"Interface identifier",
                  "required":true,
                  "type":"integer",
                  "format":"int32"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation",
                  "schema":{
                     "$ref":"#/definitions/Interface"
                  }
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      },
      "/lua/rest/get/host/data.lua":{
         "get":{
            "tags":[
               "Hosts"
            ],
            "summary":"Get host data",
            "description":"Host data is returned",
            "operationId":"host_get_json",
            "produces":[
               "application/json"
            ],
            "parameters":[
               {
                  "name":"ifid",
                  "in":"query",
                  "description":"Interface identifier",
                  "required":true,
                  "type":"integer",
                  "format":"int32"
               },
               {
                  "name":"host",
                  "in":"query",
                  "description":"Host address",
                  "required":true,
                  "type":"string"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation",
                  "schema":{
                     "$ref":"#/definitions/Host"
                  }
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      },
      "/lua/rest/get/alert/data.lua":{
         "get":{
            "tags":[
               "Alerts"
            ],
            "summary":"Get alerts data",
            "description":"Alerts are returned",
            "operationId":"get_alerts_data",
            "produces":[
               "application/json"
            ],
            "parameters":[
               {
                  "name":"status",
                  "in":"query",
                  "description":"Status filter (historical, historical-flows, engaged)",
                  "required":true,
                  "type":"string"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation",
                  "schema":{
                     "$ref":"#/definitions/Alert"
                  }
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      },
      "/lua/pro/rest/get/db/flows.lua":{
         "get":{
            "tags":[
               "Flows"
            ],
            "summary":"Get flows data. Columns include (but are not limited to) IP_PROTOCOL_VERSION, FLOW_TIME, FIRST_SEEN, LAST_SEEN, VLAN_ID, PACKETS, BYTES, SRC_TO_DST_BYTES, DST_TO_SRC_BYTES, IPV4_SRC_ADDR, IPV4_DST_ADDR, IPV6_SRC_ADDR, IPV6_DST_ADDR, PROTOCOL, L7_PROTO.",
            "description":"Executes a query to the flows database",
            "operationId":"get_flows_data",
            "produces":[
               "application/json"
            ],
            "parameters":[
               {
                   "name":"ifid",
                   "in":"query",
                   "description":"Interface identifier",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"begin_time_clause",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"end_time_clause",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"select_clause",
                   "in":"query",
                   "description":"Select clause (default: *)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"where_clause",
                   "in":"query",
                   "description":"Where clause (default: none)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"maxhits_clause",
                   "in":"query",
                   "description":"Max hits (default: 10)",
                   "required":false,
                   "type":"integer",
                   "format":"int32"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation"
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      },
      "/lua/pro/rest/get/db/topk_flows.lua":{
         "get":{
            "tags":[
               "Flows"
            ],
            "summary":"Get flows data. Columns include (but are not limited to) IP_PROTOCOL_VERSION, FLOW_TIME, FIRST_SEEN, LAST_SEEN, VLAN_ID, PACKETS, BYTES, SRC_TO_DST_BYTES, DST_TO_SRC_BYTES, IPV4_SRC_ADDR, IPV4_DST_ADDR, IPV6_SRC_ADDR, IPV6_DST_ADDR, PROTOCOL, L7_PROTO",
            "description":"Executes a top-k query to the flows database",
            "operationId":"get_topk_data",
            "produces":[
               "application/json"
            ],
            "parameters":[
               {
                   "name":"ifid",
                   "in":"query",
                   "description":"Interface identifier",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"begin_time_clause",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"end_time_clause",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"select_keys_clause",
                   "in":"query",
                   "description":"Select keys (default: IPV4_SRC_ADDR,IPV4_DST_ADDR,L7_PROTO)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"select_values_clause",
                   "in":"query",
                   "description":"Select values (default: BYTES)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"where_clause",
                   "in":"query",
                   "description":"Where clause (default: none)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"topk_clause",
                   "in":"query",
                   "description":"Top-K clause (default: SUM)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"approx_search",
                   "in":"query",
                   "description":"Approximate search (default: true)",
                   "required":false,
                   "type":"string"
               },
               {
                   "name":"maxhits_clause",
                   "in":"query",
                   "description":"Max hits (default: 10)",
                   "required":false,
                   "type":"integer",
                   "format":"int32"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation"
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      },
      "/lua/rest/get/pcap/live_extraction.lua":{
         "get":{
            "tags":[
               "PCAP"
            ],
            "summary":"Live PCAP traffic extraction",
            "description":"Raw PCAP data is returned",
            "operationId":"live_traffic_extraction",
            "produces":[
               "application/vnd.tcpdump.pcap"
            ],
            "parameters":[
               {
                   "name":"ifid",
                   "in":"query",
                   "description":"Interface identifier",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"epoch_begin",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"epoch_end",
                   "in":"query",
                   "description":"Start time (epoch)",
                   "required":true,
                   "type":"integer",
                   "format":"int32"
               },
               {
                   "name":"bpf_filter",
                   "in":"query",
                   "description":"BPF filter",
                   "required":false,
                   "type":"string"
               }
            ],
            "responses":{
               "200":{
                  "description":"successful operation"
               },
               "400":{
                  "description":"Invalid status value"
               }
            }
         }
      }
   },
   "definitions":{
      "Interface":{
         "type":"object",
         "properties":{
            "ifname":{
               "type":"string"
            },
            "is_view":{
               "type":"boolean",
               "default":false
            },
            "id":{
               "type":"integer",
               "format":"int64"
            },
            "speed":{
               "type":"integer",
               "format":"int32"
            },
            "epoch":{
               "type":"integer",
               "format":"int32"
            },
            "packets":{
               "type":"integer",
               "format":"int64"
            },
            "packets":{
               "type":"integer",
               "format":"int64"
            },
            "bytes":{
               "type":"integer",
               "format":"int64"
            },
            "drops":{
               "type":"integer",
               "format":"int64"
            },
            "num_devices":{
               "type":"integer",
               "format":"int32"
            },
            "num_hosts":{
               "type":"integer",
               "format":"int32"
            },
            "num_flows":{
               "type":"integer",
               "format":"int32"
            },
            "remote_bps":{
               "type":"integer",
               "format":"int32"
            },
            "remote_pps":{
               "type":"integer",
               "format":"int32"
            },
            "remote2local":{
               "type":"integer",
               "format":"int32"
            },
            "local2remote":{
               "type":"integer",
               "format":"int32"
            },
            "num_local_hosts":{
               "type":"integer",
               "format":"int32"
            },
            "alerts_stored":{
               "type":"boolean"
            },
            "engaged_alerts":{
               "type":"integer",
               "format":"int32"
            },
            "tcpPacketStats":{
               "type":"object",
			   "properties":{
	              "retransmissions":{
	                 "type":"integer",
	                 "format":"int32"
	              },
	              "lost":{
	                 "type":"integer",
	                 "format":"int32"
	              },
	              "out_of_order":{
	                 "type":"integer",
	                 "format":"int32"
	              }
			   }
            }
         }
      },
      "Host":{
          "type":"object",
          "properties":{
             "localHost":{
                "type":"boolean"
             },
             "ifid":{
                 "type":"integer",
                 "format":"int32"
             },
             "mac_address":{
                "type":"string"
             },
             "symbolic_name":{
                "type":"string"
             },
             "seen.first":{
                "type":"integer",
                "format":"int32"
             },
             "seen.last":{
                "type":"integer",
                "format":"int32"
             },
             "flows.as_client":{
                 "type":"integer",
                 "format":"int32"
             },
             "flows.as_server":{
                 "type":"integer",
                 "format":"int32"
             },
             "throughput_pps":{
                 "type":"number"
             },
             "throughput_bps":{
                 "type":"number"
             },
             "os":{
                "type":"string"
             },
             "systemHost":{
                "type":"boolean"
             },
             "throughput_trend_pps":{
                "type":"string"
             },
             "throughput_trend_bps":{
                "type":"string"
             },
             "total_activity_time":{
                "type":"integer",
                "format":"int32"
             },
             "num_alerts":{
                "type":"integer",
                "format":"int32"
             },
             "is_blacklisted":{
                "type":"boolean"
             },
             "asn":{
                "type":"integer",
                "format":"int32"
             },
             "rcvd":{
                "type":"object",
                "properties":{
	                "packets":{
	                   "type":"integer",
	                   "format":"int32"
	                },
	                "bytes":{
	                   "type":"integer",
	                   "format":"int32"
	                }
				}
             },
             "sent":{
                "type":"object",
                "properties":{
	                "packets":{
	                   "type":"integer",
	                   "format":"int32"
	                },
	                "bytes":{
	                   "type":"integer",
	                   "format":"int32"
	                }
				}
             },
             "ip":{
                "type":"object",
                "properties":{
	                "localHost":{
	                   "type":"boolean"
	                },
	                "ip":{
	                   "type":"string"
	                },
	                "ipVersion":{
	                   "type":"integer",
	                   "format":"int32"
	                }
				}
             }
		 }
      },
      "Alert":{
         "type":"array",
	 "items":{
            "type":"object",
	    "properties":{
	       "entity":{
	          "type":"string"
	       },
  	       "msg":{
  	          "type":"string"
  	       },
  	       "duration":{
  	          "type":"string"
  	       },
  	       "date":{
  	          "type":"string"
  	       },
  	       "type":{
  	          "type":"string"
  	       },
  	       "key":{
  	          "type":"string"
  	       },
  	       "entity_val":{
  	          "type":"string"
  	       },
  	       "severity":{
  	          "type":"string"
  	       }
            }
	 }
      }
   }
}


--
-- (C) 2019-23 - ntop.org
--

--
-- This script performs the scheduled vulnerability scans
--

local dirs = ntop.getDirs()
package.path = dirs.installdir .. "/scripts/lua/modules/?.lua;" .. package.path
package.path = dirs.installdir .. "/scripts/lua/modules/vulnerability_scan/?.lua;".. package.path
local vs_utils = require "vs_utils"


local use_coroutines = true
local max_num_scans_for_loop = 64 -- avoid lasting too long (too many loops)
local num_scans = vs_utils.process_all_scheduled_scans(max_num_scans_for_loo, use_coroutines)


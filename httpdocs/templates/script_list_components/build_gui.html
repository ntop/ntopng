const build_gui = (gui, hooks) => {

   const build_input_box = ({ input_builder, field_max, field_min, fields_unit, field_operator }) => {

      if (input_builder == '' || input_builder == undefined || input_builder == null) {
         return $("<p>Not enabled!</p>")
      }
      else if (input_builder == 'threshold_cross') {
         return $(`<div class='input-group template w-75'></div>`)
            .append(`<div class='input-group-prepend'>
                   <select class='btn btn-outline-secondary'>
                         <option selected value="gt">&gt</option>
                         <option value="lt">&lt;</option>
                   </select>
             </div>`)
            .append(`<input type='number' 
                            class='form-control'
                            min='${field_min == undefined ? '' : field_min}'
                            max='${field_max == undefined ? '' : field_max}'>`)
            .append(`<span class='mt-auto mb-auto ml-2 mr-2'>${fields_unit}</span>`)
            .append(`<div class="invalid-feedback">{message}</div>`)
      }

   }

   const build_hook = ({ label, enabled, script_conf }, granularity) => {

      // create table row inside the edit form
      const $element = $("<tr></tr>").attr("id", granularity);

      // create checkbox for hook
      $element.append(`<td class='text-center'>
          <input name="${granularity}-check" type="checkbox" ${enabled ? "checked" : ""} >
       </td>`);

      // create label for hook
      $element.append(`<td><label>${label}</label></td>`);

      // create input_box
      const $input_box = build_input_box(gui);

      // enable readonly in inputboxes and selects if enabled field is false
      if (!enabled) {
         $input_box.find("input[type='number']").attr("readonly", "");
         $input_box.find("select").attr("disabled", "");
      }

      // select the right operator
      if (script_conf.operator != undefined) {
         $input_box.find("select").attr("name", `${granularity}-select`).val(script_conf.operator)
      }
      // set input name
      $input_box.find("input[type='number']").attr("name", `${granularity}-input`)
      // set script conf params
      $input_box.find("input[type='number']").val(script_conf.threshold);
      // set placeholder
      // $input_box.find("input[type='number']").attr("placeholder", script_conf.threshold);

      // bind check event on checkboxes
      $element.on('change', "input[type='checkbox']", function (e) {

         const checked = $(this).prop('checked');

         if (!checked) {
            $input_box.find("input[type='number']").attr("readonly", "");
            $input_box.find("select").attr("disabled", "");
            return;
         }

         $input_box.find("input[type='number']").removeAttr("readonly");
         $input_box.find("select").removeAttr("disabled");

      })

      const $input_container = $(`<td></td>`).append($input_box);
      $element.append($input_container);

      return $element;
   }


   // append hooks to table
   if ("5mins" in hooks) {
      $table_editor.append(build_hook(hooks["5mins"], "5mins"));
   }
   if ("hour" in hooks) {
      $table_editor.append(build_hook(hooks["hour"], "hour"));
   }
   if ("day" in hooks) {
      $table_editor.append(build_hook(hooks["day"], "day"));
   }
   if ("min" in hooks) {
      $table_editor.append(build_hook(hooks["min"], "min"));
   }

}
